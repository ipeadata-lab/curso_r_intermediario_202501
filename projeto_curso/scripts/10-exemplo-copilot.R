# carregar pacotes
library(tidyverse)

# carregar dados
voos <- read_csv2("dados/voos_dez-2024-alterado.csv")

glimpse(voos)
# Rows: 82,003
# # Columns: 26
# $ id_basica             <dbl> 33821878, 33972533, 33819746, 33819747, 33914237, 33914239, 33914269, 33914304, 33914319, 33914324, 33820263…
# $ id_empresa            <dbl> 1002650, 1001070, 1007570, 1007570, 1000896, 1000896, 1000896, 1000896, 1000896, 1000896, 1007303, 1007303, …
# $ nm_empresa            <chr> "DHL AERO EXPRESO", "AEROVÍAS DE MÉXICO S.A DE C.V - AEROMÉXICO", "ARAJET S.A.", "ARAJET S.A.", "DELTA AIR L…
# $ dt_referencia         <date> 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01, 2024-12-01,…
# $ ds_di                 <chr> "INCLUSÃO DE ETAPA EM UM VOO PREVISTO EM HOTRAN", "REGULAR PREVISTO EM HOTRAN", "REGULAR PREVISTO EM HOTRAN"…
# $ ds_grupo_di           <chr> "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR", "REGULAR"…
# $ ds_natureza_etapa     <chr> "INTERNACIONAL", "INTERNACIONAL", "INTERNACIONAL", "INTERNACIONAL", "INTERNACIONAL", "INTERNACIONAL", "INTER…
# $ hr_partida_real       <time> 13:35:00, 10:15:00, 05:34:00, 19:45:00, 20:24:00, 01:04:00, 21:09:00, 00:17:00, 23:00:00, 10:31:00, 02:00:0…
# $ dt_partida_real       <chr> "01/12/2024", "01/12/2024", "01/12/2024", "30/11/2024", "01/12/2024", "01/12/2024", "01/12/2024", "01/12/202…
# $ id_aerodromo_origem   <dbl> 467, 301, 301, 609, 66, 66, 301, 500, 301, 301, 138, 626, 263, 136, 136, 301, 626, 626, 138, 626, 136, 136, …
# $ nm_aerodromo_origem   <chr> "MIAMI INTERNATIONAL AIRPORT", "GUARULHOS - GOVERNADOR ANDRÉ FRANCO MONTORO", "GUARULHOS - GOVERNADOR ANDRÉ …
# $ nm_municipio_origem   <chr> "MIAMI, FLORIDA", "GUARULHOS", "GUARULHOS", "PUNTA CANA", "ATLANTA", "ATLANTA", "GUARULHOS", "NEW YORK, NEW …
# $ sg_uf_origem          <chr> NA, "SP", "SP", NA, NA, NA, "SP", NA, "SP", "SP", NA, "RJ", "SC", NA, NA, "SP", "RJ", "RJ", NA, "RJ", NA, NA…
# $ nm_regiao_origem      <chr> NA, "SUDESTE", "SUDESTE", NA, NA, NA, "SUDESTE", NA, "SUDESTE", "SUDESTE", NA, "SUDESTE", "SUL", NA, NA, "SU…
# $ nm_pais_origem        <chr> "ESTADOS UNIDOS DA AMÉRICA", "BRASIL", "BRASIL", "REPÚBLICA DOMINICANA", "ESTADOS UNIDOS DA AMÉRICA", "ESTAD…
# $ nm_continente_origem  <chr> "AMÉRICA DO NORTE", "AMÉRICA DO SUL", "AMÉRICA DO SUL", "AMÉRICA CENTRAL", "AMÉRICA DO NORTE", "AMÉRICA DO N…
# $ hr_chegada_real       <time> 22:46:00, 19:01:00, 11:42:00, 03:28:00, 05:42:00, 10:17:00, 06:35:00, 09:57:00, 08:57:00, 20:23:00, 03:45:0…
# $ dt_chegada_real       <dbl> 45627, 45627, 45627, 45627, 45628, 45627, 45628, 45627, 45628, 45627, 45627, 45628, 45627, 45627, 45627, 456…
# $ id_aerodromo_destino  <dbl> 162, 466, 609, 301, 301, 301, 500, 301, 66, 66, 263, 136, 138, 626, 626, 136, 136, 136, 626, 138, 626, 301, …
# $ nm_aerodromo_destino  <chr> "VIRACOPOS", "BENITO JUAREZ INTL", "PUNTA CANA", "GUARULHOS - GOVERNADOR ANDRÉ FRANCO MONTORO", "GUARULHOS -…
# $ nm_municipio_destino  <chr> "CAMPINAS", "MEXICO", "PUNTA CANA", "GUARULHOS", "GUARULHOS", "GUARULHOS", "NEW YORK, NEW YORK", "GUARULHOS"…
# $ sg_uf_destino         <chr> "SP", NA, NA, "SP", "SP", "SP", NA, "SP", NA, NA, "SC", NA, NA, "RJ", "RJ", NA, NA, NA, "RJ", NA, "RJ", "SP"…
# $ nm_regiao_destino     <chr> "SUDESTE", NA, NA, "SUDESTE", "SUDESTE", "SUDESTE", NA, "SUDESTE", NA, NA, "SUL", NA, NA, "SUDESTE", "SUDEST…
# $ nm_pais_destino       <chr> "BRASIL", "MÉXICO", "REPÚBLICA DOMINICANA", "BRASIL", "BRASIL", "BRASIL", "ESTADOS UNIDOS DA AMÉRICA", "BRAS…
# $ nm_continente_destino <chr> "AMÉRICA DO SUL", "AMÉRICA DO NORTE", "AMÉRICA CENTRAL", "AMÉRICA DO SUL", "AMÉRICA DO SUL", "AMÉRICA DO SUL…
# $ dt_sistema            <dttm> 2025-01-04 01:00:02, 2025-01-10 01:00:09, 2025-01-02 01:00:59, 2025-01-02 01:00:59, 2025-01-09 01:00:08, 20…


# contagem de voos por estado de origem

voos |>
  count(sg_uf_origem)


# contagem de voos por estado de destino

voos |>
  count(sg_uf_destino)


# gráfico de voos por estado de origem

voos |>
  count(sg_uf_origem) |>
  ggplot() +
  aes(x = reorder(sg_uf_origem, n), y = n) +
  geom_col() +
  coord_flip() +
  labs(x = "Estado de origem", y = "Quantidade de voos", title = "Quantidade de voos por estado de origem")
